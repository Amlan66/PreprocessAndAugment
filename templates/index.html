<!DOCTYPE html>
<html>
<head>
    <title>Text Processing App</title>
    <link rel="stylesheet" href="{{ url_for('static', path='style.css') }}">
</head>
<body>
    <div class="container">
        <h1>Text Processing App</h1>
        
        <!-- File Upload Section -->
        <div class="section">
            <h2>Upload Text File</h2>
            <input type="file" id="fileInput" accept=".txt">
            <button onclick="uploadFile()">Upload</button>
        </div>

        <!-- Original Text Display -->
        <div class="section">
            <h2>Original Text</h2>
            <div class="text-box" id="originalText">{{ original_text }}</div>
        </div>

        <!-- Processing Options -->
        <div class="section">
            <h2>Processing Options</h2>
            <div class="options-container">
                <div class="options">
                    <h3>Select Preprocessing Method:</h3>
                    <div class="select-wrapper">
                        <select id="preprocessingMethod">
                            <option value="none">No Preprocessing</option>
                            <option value="tokenize">Tokenization</option>
                            <option value="removePunct">Remove Punctuation</option>
                            <option value="addPadding">Add Padding</option>
                        </select>
                    </div>
                </div>
                <div class="options">
                    <h3>Select Augmentation Method:</h3>
                    <div class="select-wrapper">
                        <select id="augmentationMethod">
                            <option value="none">No Augmentation</option>
                            <option value="synonymReplace">Synonym Replacement</option>
                            <option value="randomInsert">Random Word Insertion</option>
                        </select>
                    </div>
                </div>
            </div>
            <button onclick="processText()" class="process-btn">Process Text</button>
        </div>

        <!-- Results Section -->
        <div class="section results">
            <h2>Results</h2>
            <div class="result-box">
                <h3>Preprocessed Text</h3>
                <div class="text-box" id="processedText">{{ processed_text | safe }}</div>
            </div>
            <div class="result-box">
                <h3>Augmented Text</h3>
                <div class="text-box" id="augmentedText">{{ augmented_text | safe }}</div>
            </div>
        </div>
    </div>

    <script>
        async function uploadFile() {
            try {
                const fileInput = document.getElementById('fileInput');
                const file = fileInput.files[0];
                if (!file) {
                    alert('Please select a file first');
                    return;
                }

                const formData = new FormData();
                formData.append('file', file);

                const response = await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                document.getElementById('originalText').textContent = data.text;
                document.getElementById('processedText').innerHTML = '';
                document.getElementById('augmentedText').innerHTML = '';
            } catch (error) {
                console.error('Error uploading file:', error);
                alert('Error uploading file');
            }
        }

        async function processText() {
            try {
                const text = document.getElementById('originalText').textContent;
                if (!text) {
                    alert('Please upload a text file first');
                    return;
                }

                await Promise.all([
                    handlePreprocessing(text),
                    handleAugmentation(text)
                ]);

            } catch (error) {
                console.error('Error processing text:', error);
                alert('Error processing text');
            }
        }

        async function handlePreprocessing(text) {
            const preprocessMethod = document.getElementById('preprocessingMethod').value;
            const formData = new FormData();
            formData.append('text', text);
            formData.append('tokenize', preprocessMethod === 'tokenize');
            formData.append('remove_punct', preprocessMethod === 'removePunct');
            formData.append('add_padding', preprocessMethod === 'addPadding');

            const response = await fetch('/preprocess', {
                method: 'POST',
                body: formData
            });
            const data = await response.json();
            document.getElementById('processedText').innerHTML = data.processed_text;
        }

        async function handleAugmentation(text) {
            const augmentMethod = document.getElementById('augmentationMethod').value;
            const formData = new FormData();
            formData.append('text', text);
            formData.append('synonym_replace', augmentMethod === 'synonymReplace');
            formData.append('random_insert', augmentMethod === 'randomInsert');

            const response = await fetch('/augment', {
                method: 'POST',
                body: formData
            });
            const data = await response.json();
            document.getElementById('augmentedText').innerHTML = data.augmented_text;
        }
    </script>
</body>
</html> 